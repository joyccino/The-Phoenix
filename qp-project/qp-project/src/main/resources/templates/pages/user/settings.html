<!DOCTYPE html>
<html data-bs-theme="light" lang="en-US" dir="ltr" xmlns="http://www.w3.org/1999/html" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <!-- ===============================================-->
    <!--    Document Title-->
    <!-- ===============================================-->
    <title>Falcon | Dashboard &amp; Web App Template</title>


    <!-- ===============================================-->
    <!--    Favicons-->
    <!-- ===============================================-->
    <link rel="apple-touch-icon" sizes="180x180" href="../../assets/img/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../assets/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../assets/img/favicons/favicon-16x16.png">
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/img/favicons/favicon.ico">
    <link rel="manifest" href="../../assets/img/favicons/manifest.json">
    <meta name="msapplication-TileImage" content="../../assets/img/favicons/mstile-150x150.png">
    <meta name="theme-color" content="#ffffff">
    <script src="../../assets/js/config.js"></script>
    <script src="../../vendors/simplebar/simplebar.min.js"></script>


    <!-- ===============================================-->
    <!--    Stylesheets-->
    <!-- ===============================================-->
    <link href="../../vendors/flatpickr/flatpickr.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <!-- <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700%7cPoppins:300,400,500,600,700,800,900&amp;display=swap" rel="stylesheet">-->
    <link href="https://webfontworld.github.io/NanumSquareNeo/NanumSquareNeo.css" rel="stylesheet">    <link href="../../vendors/simplebar/simplebar.min.css" rel="stylesheet">
    <link href="../../assets/css/theme-rtl.css" rel="stylesheet" id="style-rtl">
    <link href="../../assets/css/theme.css" rel="stylesheet" id="style-default">
    <link href="../../assets/css/user-rtl.css" rel="stylesheet" id="user-style-rtl">
    <link href="../../assets/css/user.css" rel="stylesheet" id="user-style-default">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
      var isRTL = JSON.parse(localStorage.getItem('isRTL'));
      if (isRTL) {
        var linkDefault = document.getElementById('style-default');
        var userLinkDefault = document.getElementById('user-style-default');
        linkDefault.setAttribute('disabled', true);
        userLinkDefault.setAttribute('disabled', true);
        document.querySelector('html').setAttribute('dir', 'rtl');
      } else {
        var linkRTL = document.getElementById('style-rtl');
        var userLinkRTL = document.getElementById('user-style-rtl');
        linkRTL.setAttribute('disabled', true);
        userLinkRTL.setAttribute('disabled', true);
      }
    </script>
</head>


<body>

<!-- ===============================================-->
<!--    Main Content-->
<!-- ===============================================-->
<main class="main" id="top">
    <div class="container" data-layout="container">
        <script>
          var isFluid = JSON.parse(localStorage.getItem('isFluid'));
          if (isFluid) {
            var container = document.querySelector('[data-layout]');
            container.classList.remove('container');
            container.classList.add('container-fluid');
          }
        </script>
        <!-- sidebar start -->
        
        <!-- sidebar end -->
        <!-- main content start -->
        <div class="content">
            <!-- top nav start -->
            <nav class="navbar navbar-light navbar-glass navbar-top navbar-expand-lg">
                <button class="btn navbar-toggler-humburger-icon navbar-toggler me-1 me-sm-3" type="button" data-bs-toggle="collapse" data-bs-target="#navbarStandard" aria-controls="navbarStandard" aria-expanded="false" aria-label="Toggle Navigation"><span class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>
                <a class="navbar-brand" href="../quiz/home">
                    <div class="d-flex align-items-center py-3"><img class="me-2" src="../../assets/img/icons/qp-transparent.png" alt="" width="55" /><span class="font-sans-serif">project</span>
                    </div>
                </a>
                <ul class="navbar-nav navbar-nav-icons ms-auto flex-row align-items-center">
                    <li class="nav-item dropdown">
                        <a class="nav-link pe-0 ps-2" id="navbarDropdownUser" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <div class="avatar avatar-xl">
                                <img class="rounded-circle" src="../../../assets/img/icons/cookie.png" alt="" />
                            </div>
                        </a>
                        <div class="dropdown-menu dropdown-caret dropdown-menu-end py-0" aria-labelledby="navbarDropdownUser">
                            <div class="bg-white dark__bg-1000 rounded-2 py-2">
                                <!--                            <a class="dropdown-item fw-bold text-warning" href="#!"><span class="fas fa-crown me-1"></span><span>Go Pro</span></a>-->
                                <!--                            -->
                                <!--                            <div class="dropdown-divider"></div>-->
                                <!--                            <a class="dropdown-item" href="#!">Set status</a>-->
                                <!--                            <a class="dropdown-item" href="../../../pages/user/profile.html">Profile &amp; account</a>-->
                                <!--                            <a class="dropdown-item" href="#!">Feedback</a>-->
                                <!--                            -->
                                <!--                            <div class="dropdown-divider"></div>-->
                                <a class="dropdown-item" href="../auth/memberList">회원 관리</a>
                                <a class="dropdown-item" href="../auth/analytics">애널리틱스</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="../mypage/edit">마이페이지</a>
                                <a class="dropdown-item" href="../auth/logout">로그아웃</a>
                            </div>
                        </div>
                    </li>
                </ul>
            </nav>
            <!-- top nav end -->
            <div class="card mb-3">
                <div class="bg-holder d-none d-lg-block bg-card" style="background-image:url(../../../assets/img/icons/spot-illustrations/corner-4.png);">
                </div>
                <!--/.bg-holder-->
                <div class="card-body z-1">
                    <h3>마이페이지</h3>
                </div>
            </div>
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                <li class="nav-item"><a class="nav-link active" id="settingTab" data-bs-toggle="tab" href="#tabPersonalInfo" role="tab" aria-controls="tabSetting" aria-selected="true">기본정보 수정</a></li>
                <li class="nav-item"><a class="nav-link" id="passTab" data-bs-toggle="tab" href="#tabPass" role="tab" aria-controls="tabForm" aria-selected="false">비밀번호 수정</a></li>
                <li class="nav-item"><a class="nav-link" id="membershipTab" data-bs-toggle="tab" href="#tabMembership" role="tab" aria-controls="tabForm" aria-selected="false">멤버십 관리</a></li>
                <li class="nav-item"><a class="nav-link" id="dangerTab" data-bs-toggle="tab" href="#tabWithdrawal" role="tab" aria-controls="tabForm" aria-selected="false" style="color:#A9A9A9">탈퇴</a></li>

            </ul>
            <!-- 메뉴 탭바 시작 -->
            <div class ="tab-content border-x border-bottom p-3" id="myTabContent">
                <!-- 기본정보 수정 -->
                <div class="tab-pane fade show active" id="tabPersonalInfo" role="tabpanel" aria-labelledby="settingTab">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h5 class="mb-0"><b>기본정보</b></h5>
                        </div>
                        <div class="card-body bg-light">
                            <form autocomplete="off" th:action="@{/auth/memberUpdate}" method="post" id="editProfile">
                                <div class="row gx-2">

                                    <div class="mb-3 col-sm-6">
                                        <label class="form-label" for="card-surname">성</label>
                                        <input class="form-control" type="text" autocomplete="none" id="card-surname" name ="memberSurname"
                                               oninput="nameCheck(document.getElementById('card-surname'));"
                                               onblur = "validateSurName(document.getElementById('card-surname'))"
                                               required readonly onfocus="this.removeAttribute('readonly');"
                                               th:value="${qpUser.memberSurname}"/>
                                    </div>
                                    <div class="mb-3 col-sm-6">
                                        <label class="form-label" for="card-firstname">이름</label>
                                        <input class="form-control" type="text" autocomplete="none" id="card-firstname" name ="memberFirstname"
                                               oninput="nameCheck(document.getElementById('card-firstname'));"
                                               onblur = "validateFirstName(document.getElementById('card-firstname'))"
                                               required readonly onfocus="this.removeAttribute('readonly');"
                                               th:value="${qpUser.memberFirstname}"/>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label" for="card-userId">아이디</label>
                                    <input class="form-control" type="text" autocomplete="off" id="card-userId" name ="memberId" oninput="idCheck(document.getElementById('card-userId'));" required readonly onfocus="this.removeAttribute('readonly');"
                                           th:value="${qpUser.memberId}" th:data-origin="${qpUser.memberId}"/>
                                    <label class='form-label' id = "userIdCheckMsg" style="display:none"></label>
                                </div>
                                <div class="mb-3">
                                    <label class=>성별</label>
                                    <select class="form-select mb-3" name ="memberGender" th:data-gender="${qpUser.memberGender}" ><!-- onload="setGender();" -->
                                        <option value="2" selected>선택 안함</option>
                                        <option value="0">남</option>
                                        <option value="1">여</option>
                                    </select>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label" for="card-birthdate">생년월일</label>
                                    <input class="form-control" th:value="${#dates.format(qpUser.memberBDate, 'yyyy-MM-dd')}" type="date" autocomplete="on" id="card-birthdate" name ="memberBDate" required oninput="birthdateCheck()"/>
                                    <label class="form-label" id="birthdate-error-msg" style="color:red; display:none;">생년월일을 확인해주세요.</label>
                                </div>

                                <!--<div class="mb-3">
                                    <label class="form-label" for="card-contact-number">전화번호</label>
                                    <input th:value="${qpUser.memberBDate}"
                                           class="form-control" type="number" step="1" autocomplete="none" id="card-contact-number" onchange ="preventKCharacter();" maxlength="11"
                                           onkeydown="return event.keyCode !== 69"
                                           oninput="check_phoneNumber(); javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                                           readonly onfocus="this.removeAttribute('readonly');">
                                    <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52" style="display: none" id="contact-no-verified">
                                        <circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>
                                        <path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
                                    </svg>
                                    </input>
                                    <label class='form-label' id = "phoneNoCheck" style="display: none"></label>
                                </div>-->

                                <div class="mb-3">
                                    <label class="form-label" for="card-email" id ="email-address">이메일 주소</label>
                                    <input class="form-control" th:data-origin="${qpUser.memberEmail}" th:value="${qpUser.memberEmail}" type="email" autocomplete="none" id="card-email" name ="memberEmail" required readonly onfocus="this.removeAttribute('readonly');"> <!-- oninput="check_email()" -->
<!--                                <input class="form-control" type="text" id="card-memberEmailIsChanged" name ="memberEmailIsChanged" style="display:none;"/>-->
                                    <label class='form-label' id = "emailCheck" style="display: none"></label>
                                </div>

<!--                                <div class="mb-3">-->
<!--                                    <label class="form-label" for="card-emailIsChanged" id ="email-changed"></label>-->
<!--                                    <input class="form-control" type="text" autocomplete="none" id="card-emailIsChanged" name ="memberEmailIsChanged" required readonly value="" style="display:none;"/>-->
<!--                                </div>-->

                                <div class="mb-3" style = "display: none" id = "uni-name">
                                    <label class="form-label" for="card-uni" id ="uni-name-label">재학중인 학교명</label>
                                    <input class="form-control" th:value="${qpUser.memberInstitutionId}" type="text" autocomplete="on" id="card-uni" readonly/>
                                </div>

                                <div class="form-check" style="position:absolute;left:-999999px">
                                    <input class="form-check-input" type="checkbox" id="chkUniStudent" />
                                    <label class="form-label" for="chkUniStudent" >대학생입니다.</label>
                                </div>

                                <button class="btn btn-primary d-block w-100" type="submit" id="submit-btn" onclick="memberUpdate();">회원 정보 저장</button>

                                <div class="mb-3" style ="display: none">
                                    <label class="form-label" for="card-major">전공</label>
                                    <input class="form-control" type="text" autocomplete="on" id="card-major" placeholder = "디폴트 설정으로 숨겨져 있을것."/>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!--기본정보 수정 끝-->

                <!--비밀번호 수정-->
                <div class="tab-pane fade" id="tabPass" role="tabpanel" aria-labelledby="settingTab">
                    <div class="card mb-3 overflow-hidden">
                        <div class="card-header">
                            <h5 class="mb-0"><b>비밀번호</b></h5>
                        </div>
                        <div class="card-body bg-light">
                            <div class="mb-3">
                                <label class="form-label" for="old-password">기존 비밀번호</label>
                                <input class="form-control" id="old-password" type="password" required/>
                            </div>
                            <div class="mb-3">
                                <label class="form-label" for="new-password" >새 비밀번호</label>
                                <input class="form-control" id="new-password" type="password" required oninput="passCheck()"/>
                                <label class="form-label" id="psCheck" style="display: none"></label>
                                <label class="form-label" id="pCheck" style="display: block; color: red;">8자에서 20자 사이의 비밀번호를 입력해주세요.</label>
                            </div>
                            <div class="mb-3" id="div-cpass" style="display:none;">
                                <label class="form-label" for="confirm-password" >비밀번호 확인</label>
                                <input class="form-control" id="confirm-password" type="password" required oninput ="passCheck();"/>
                                <label class="form-label" id="matchCheck" style="display: block; color: red;">비밀번호를 입력해주세요.</label>
                            </div>
                            <button class="btn btn-primary d-block w-100" id="passUpdateBtn" onclick="passUpdate();" disabled>비밀번호 변경</button>
                        </div>
                    </div>
                </div>
                <!--비밀번호 수정 끝-->

                <!-- 멤버십 관리 -->
                <div class="tab-pane fade" id="tabMembership" role="tabpanel" aria-labelledby="settingTab">
                    <div class="card mb-3 overflow-hidden">
                        <div class="card-header">
                            <h5 class="mb-0"><b>멤버십 관리</b></h5>
                        </div>
                        <div class="card-body bg-light">
                            <h5>Plan</h5>
                            <p class="fs-0"><strong>Developer</strong>- Unlimited private repositories</p><a class="btn btn-falcon-default btn-sm" href="#!">Update Plan</a>
                        </div>
                        <div class="card-body bg-light border-top">
                            <h5>Payment</h5>
                            <p class="fs-0">You have not added any payment.</p><a class="btn btn-falcon-default btn-sm" href="#!">Add Payment </a>
                        </div>
                    </div>
                </div>
                <!-- 멤버십 관리 끝-->

                <!-- 회원 탈퇴 -->
                <div class="tab-pane fade" id="tabWithdrawal" role="tabpanel" aria-labelledby="settingTab">
                    <div class="card mb-3 overflow-hidden">
                        <div class="card-header">
                            <h5 class="fs-0">회원 탈퇴</h5>
                            <p class="fs--1">회원 탈퇴 작업은 취소할 수 없습니다.</p>
                            <a class="btn btn-falcon-danger d-block" onclick="deactivate();">회원 탈퇴</a>
                        </div>
                    </div>
                </div>
                <!-- 회원 탈퇴 끝-->



            </div>
            <!-- 메뉴 탭바 끝 -->
        </div>
    </div>
</main>
<!-- ===============================================-->
<!--    End of Main Content-->
<!-- ===============================================-->


<!-- ===============================================-->
<!--    JavaScripts-->
<!-- ===============================================-->
<script src="../../vendors/popper/popper.min.js"></script>
<script src="../../vendors/bootstrap/bootstrap.min.js"></script>
<script src="../../vendors/anchorjs/anchor.min.js"></script>
<script src="../../vendors/is/is.min.js"></script>
<script src="../../assets/js/flatpickr.js"></script>
<script src="../../vendors/fontawesome/all.min.js"></script>
<script src="../../vendors/lodash/lodash.min.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
<script src="../../vendors/list.js/list.min.js"></script>
<script src="../../assets/js/theme.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<script>
    // 모든 입력 필드의 상태
    let inputs = {
        surName: true, // done
        firstName: true, //done
        id: true, // done
        gender : true,
        birthdate: true, // done
        email: true, // done
        password : true,
    };

    let isChangedEmail = false; //이메일 수정 여부
    let isValidEmail = false; //이메일 유효성 여부
    let isDuplicatedEmail = false; //이메일 중복 여부

    function memberUpdate(){
        // 이메일 변경된 경우에만 이메일 전송하기.
        if(isChangedEmail){
            alert("인증 코드가 이메일로 전송되었습니다.\n이메일 인증 후 다시 로그인 해주세요.");
        }else{
            alert("정보가 수정되었습니다.");
        }
    }
    function deactivate(){
        if (confirm('회원 탈퇴 작업은 취소할 수 없습니다. 정말로 탈퇴하시겠습니까?')) {
          // 이 자리에 탈퇴 사유 드롭다운 추가.

          alert("큐피를 이용해주셔서 감사합니다");

          window.location.href='http://localhost:8080/auth/deactivate';
        }
    };

    function passUpdate(){
        let oldPass = document.querySelector('#old-password');
        let newPass = document.querySelector('#new-password');
        let confirmPass = document.querySelector('#confirm-password');
        $.ajax({
            type : "POST", // http 방식
            url : "/auth/passCheck", // ajax 통신 url
            data : { // ajax 내용 => 파라미터 : 값 이라고 생각해도 무방
                "pass" : oldPass.value,
            },
            success : function(data) {
                console.log("data: "+data);
                if (data > 0) {
                    // 새 비밀번호와 비밀번호 확인 일치하는지

                    // 새 비밀번호 update 로직 추가
                    alert("update");
                    $.ajax({
                        type : "POST", // http 방식
                        url : "/auth/passUpdate", // ajax 통신 url
                        data : { // ajax 내용 => 파라미터 : 값 이라고 생각해도 무방
                            "newPass" : newPass.value,
                        },
                        success : function(data) {
                            console.log("password updated");
                        }
                    })
                }
                else {
                    alert("비밀번호를 확인해주세요.");
                    oldPass.value = "";
                    $('#old-password').focus();
                }
            }
        })
    };

    function nameCheck(input) {
        let regExp = /[ \{\}\[\]\/?.,;:|\)*~`!^\-_+┼<>@\#$%&\'\"\\\(\=0-9]/gi;
        if (regExp.test(input.value)) {
        input.value = input.value.substring( 0 , input.value.length - 1 );
        } else if (input.value.search(/\s/) != -1) {
        input.value = input.value.substring( 0 , input.value.length - 1 );
        }
    }

    function idCheck(input) {
        var idCheckMsg = document.getElementById("userIdCheckMsg");
        idCheckMsg.style.color = "red";

        if (input.value.search(/\s/) != -1) {
        input.value = input.value.substring( 0 , input.value.length - 1 );
        }
         // 아이디 유효성 검사 코드
        validateId(true);

        // 아이디, 전화번호, 이메일주소에 class add/remove
        let userId = document.getElementById('card-userId').value;

        // regex
        const pattern = new RegExp("^[a-zA-Z][0-9a-zA-Z]{4,11}$")
        let regResult = pattern.test(userId);
        let originId = document.getElementById('card-userId').getAttribute('data-origin');
        console.log(userId);
        if(!pattern.test(userId)){
            document.getElementById("userIdCheckMsg").style.display = "inline-block";
            idCheckMsg.innerHTML = "한 글자 이상의 영문자를 포함하는 5~12자 사이의 아이디를 입력해주세요.";
            inputs.id = false;
            enableSignupButton();
        } else if (userId === originId) {
            ;
        } else {
            let userCount;
            // 여기 중복체크 기능을 추가합니다.
            $.ajax({
                type : "POST", // http 방식
                url : "/auth/idCheck", // ajax 통신 url
                data : { // ajax 내용 => 파라미터 : 값 이라고 생각해도 무방
                    "memberId" : input.value,
                },
                success : function(data) {
                    console.log("data: ");
                    console.log(data);
                    if (data > 0 ) { // 0 이상 이면 중복
                        console.log("이미 존재하는 아이디");
                        enableSignupButton();
                        document.getElementById("userIdCheckMsg").style.display = "inline-block";
                        idCheckMsg.innerHTML = "아이디가 중복됩니다.";
                        inputs.id = false;
                        enableSignupButton();
                        if(userInput.classList.contains("is-valid")) {
                            userInput.classList.remove("is-valid");
                        }
                        if(!userInput.classList.contains("is-invalid")) {
                            userInput.classList.add("is-invalid");
                        }
                    } else { // 아니면 중복아님
                        console.log("사용 가능한 아이디입니다");
                        inputs.id = true;
                        enableSignupButton();
                        document.getElementById("userIdCheckMsg").style.display = "none";
                    }
                }
            })
        }

        let userInput = document.getElementById('card-userId');
        if(inputs.id) {
            if(userInput.classList.contains("is-invalid")) {
                userInput.classList.remove("is-invalid");
            }
            if(!userInput.classList.contains("is-valid")) {
                userInput.classList.add("is-valid");
            }
        }
        else {
          if(userInput.classList.contains("is-valid")) {
            userInput.classList.remove("is-valid");
          }
          if(!userInput.classList.contains("is-invalid")) {
            userInput.classList.add("is-invalid");
          }
        }
    }

    function validateSurName(input){
        // 성 유효성 검사
        isNaN(input.value) ? inputs.surName = true : inputs.surName = false;
        enableSignupButton();
    }

    function validateFirstName(input){
        // 이름 유효성 검사
        isNaN(input.value) ? inputs.firstName = true : inputs.firstName = false;
        enableSignupButton();
    }

    function validateId(truth){
        // 아이디 유효성 검사
        truth ? inputs.id = true : inputs.id = false;
        enableSignupButton();
    }

    function enableSignupButton() {
        if (inputs.surName && inputs.firstName && inputs.id && inputs.birthdate && inputs.email) {
            document.getElementById("submit-btn").disabled = false;
            console.log(inputs.surName ,inputs.firstName, inputs.id, inputs.birthdate, inputs.email)
        } else {
            document.getElementById("submit-btn").disabled = true;
        }
    }

    //대학교 체크 함수
    const checkUniEmail = (domain) => {
        //let uniDomain = `${domain}](http://${domain}/)`
        let uniDomain = domain;
        $.ajax({
            type : "POST", // http 방식
            url : "/auth/uniCheck", // ajax 통신 url
            data : { // ajax 내용 => 파라미터 : 값 이라고 생각해도 무방
                "uniDomain" : uniDomain,
            },
            success : function(data) {
                console.log(data);
                if (data !== "empty") {
                    $("#chkUniStudent").prop("checked",true);
                    $("#chkUniStudent").css({"pointer-events":"none"});
                    $('#uni-name').show()
                    $('#card-uni').val(data);
                    return true;
                }
                else {
                    $("#chkUniStudent").prop("checked",false);
                    $('#uni-name').hide();
                    return false;
                }
            }
        })
    }

    //이메일 변화 실시간 감지
    $('#card-email').on("propertychange change paste input", function(){
        $("#chkUniStudent").css({"pointer-events":"auto"}); //대학교 체크박스 활성화
        let originEmail = $(this).attr('data-origin'); //초기 이메일 저장
        $(this).val() === originEmail ? isChangedEmail = false : isChangedEmail = true; //초기 이메일 변경여부 확인
        $('#card-emailIsChanged').attr('value',(isChangedEmail).toString());
        $('#card-emailIsChanged').val((isChangedEmail).toString());

        if(!isChangedEmail) return false; //이메일 변경되지않았으면 함수 정지

        let domain = $(this).val()
        if(!(domain.indexOf('@')==-1)) domain = domain.split('@')[1];
        checkUniEmail(domain);//대학교 확인 함수 호출

        let email = $(this).val();
        let regEmail = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;

        //이메일 중복체크
        $.ajax({
            type : "POST", // http 방식
            url : "/auth/emailCheck", // ajax 통신 url
            data : { "email" : email },
            async : false,
            success : function(data) {
                // 0 이상 이면 중복
                data == 0 ? isDuplicatedEmail = false : isDuplicatedEmail = true;
            }
        })

        //이메일 유효성 체크
        regEmail.test(email) && email.length>0 && !isDuplicatedEmail ? isValidEmail = true : isValidEmail = false;

        //이메일 유효하지않을때 문구 표시
        let eCheck = $("#emailCheck");
        eCheck.css({'color':'red'});
        if(!regEmail.test(email) && email.length>0){
            eCheck.show();
            eCheck.text('이메일 형식을 확인해주세요.');
        } else if (isDuplicatedEmail){
            eCheck.show();
            eCheck.text('이메일이 중복됩니다.');
        } else if(!isValidEmail){
            eCheck.show();
            eCheck.text('유효하지않은 이메일입니다.');
        } else if(email.length==0){
            eCheck.show();
            eCheck.text('이메일을 적어주세요.');
        }else {
            eCheck.hide();
        }

        //이메일 유효여부에 따른 버튼 활성화
        const profileSubmitBtn = $('#editProfile button')
        isValidEmail ? profileSubmitBtn.prop('disabled',false) : profileSubmitBtn.prop('disabled',true);
    })

    //대학생 체크박스 클릭시 url 비교 함수
    $('#chkUniStudent').click(function(){
        const targetDomain = $('#card-email').val().split('@')[1];
        const bool = checkUniEmail(targetDomain)
        if(bool){
            $(this).prop("checked", true);
        }else{
            $(this).prop("checked", false);
            alert('학교 이메일 도메인을 확인해 주세요.');
        }
    })

    // 비밀번호 유효성 검사
    function validatePassword(truth){
        truth ? inputs.password = true : inputs.password = false;
    }

    function passCheck() {
      let pw = $("#new-password").val();
      let number = pw.search(/[0-9]/g);
      let english = pw.search(/[a-z]/ig);
      let spece = pw.search(/[`~!@@#$%^&*|₩₩₩'₩";:₩/?]/gi);
      let reg = /^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/;
      let confirmPass = document.querySelector("#div-cpass");
      let passWarning = document.querySelector("#pCheck");
      let matchWarning = document.querySelector("#matchCheck");
      let cPassVal = $("#confirm-password").val();

      // 비밀번호 유효성 검사 false
      validatePassword(false);

      // 비밀번호 정규식
      if (pw.length < 8 || pw.length > 20) {
          passWarning.style.display = "block";
          passWarning.style.color = "red";
          passWarning.innerHTML = "8자에서 20자 사이의 비밀번호를 입력해주세요.";
          confirmPass.style.display = "none";
          $('#passUpdateBtn').prop('disabled', true);

      } else if (pw.search(/\s/) != -1) {
          passWarning.style.display = "block";
          passWarning.innerHTML = "비밀번호는 공백 없이 입력해주세요.";
          confirmPass.style.display = "none";
            $('#passUpdateBtn').prop('disabled', true);
      } else if (number < 0 || english < 0 || spece < 0) {
          passWarning.style.display = "block";
          passWarning.innerHTML = "영문,숫자,특수문자를 혼합하여 입력해주세요.";
          confirmPass.style.display = "none";
            $('#passUpdateBtn').prop('disabled', true);
      } else {
          passWarning.style.display = "none";
          confirmPass.style.display = "block";
          if (cPassVal.length == 0){
            matchWarning.style.display = "block";
            matchWarning.style.color = "red";
            matchWarning.innerHTML = "비밀번호를 입력해주세요.";
            $('#passUpdateBtn').prop('disabled', true);
          }
          else if (pw !== cPassVal) {
            matchWarning.style.display = "block";
            matchWarning.innerHTML = "비밀번호가 일치하지 않습니다.";
            $('#passUpdateBtn').prop('disabled', true);
          }
          else{
            matchWarning.style.display = "none";
            $('#passUpdateBtn').prop('disabled', false);

            // 비밀번호 유효성 검사 true
            validatePassword(true);
          }
      }
    }

    $(function(){
        //유저 성별 설렉트박스
        let genderSelect = $('select[name="memberGender"]');
        let gender = genderSelect.attr('data-gender');
        if(gender){genderSelect.children(`option[value="${gender}"]`).prop("selected",true)};

        //대학생 체크
        let domain = $('input[name="memberEmail"]').val().split('@')[1];
        checkUniEmail(domain);
    });
</script>
<style>
        .rounded-circle {
          transition: transform .7s ease-in-out;
        }
        .rounded-circle:hover {
          transform: translate(0) rotate(360deg);
        }
    </style>

</body>

</html>